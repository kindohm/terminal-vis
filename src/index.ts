import { Message, run } from "./oscReceiver";
import hash from "object-hash";
import zalgo from "to-zalgo";
// import {zalgoGeneration, zalgoRandomGeneration, unzalgoText} from 'zalgo-generator';

const eMap = [
  "ðŸ¤Œ",
  "ðŸª¿",
  "ðŸ˜",
  "ðŸ’Š",
  "ðŸ«",
  "ðŸ¦·",
  "ðŸ¥‘",
  "ðŸ¦©",
  "ðŸ’…",
  "ðŸ¦‘",
  "ðŸ”«",
  "ðŸ¬",
  "ðŸ•",
  "ðŸ’…",
  "ðŸŒˆ"
];

const eMap2 = [
  "ðŸ¥¶",
  "ðŸ‘»",
  "ðŸ©²",
  "ðŸ",
  "ðŸ¦‹",
  "ðŸ„",
  "ðŸŒˆ",
  "ðŸ³",
  "ðŸŒ®",
  "â›©ï¸",
  "ðŸ“€",
  "ðŸ”‹",
  "ðŸ©»",
  "ðŸ¤™",
  "ðŸ’¦"
];

const modWords = [
  `
fÌµÍ”Ì®Í–Ì–Í•ÌƒÌŽÌÌ’ÌÌšÍÍ…Æ°ÌµÌ»Ì”Ì‘Ì€Í’ÍŒÌÌ€Í˜cÌµÌ¦Í“ÌŸÍ‰Í‡Í†ÌŠÌ‘Í‘Ì‰Í˜ÌšÍkÌ¸Ì¡ÍÌ¤ÍšÌ¯Ì‡Ìƒ Ì¶Ì¤ÍšÌ£ÌœÌ‹Ì‡Ì‡Ì¿Ì‰ÍŠÍ‘ÍyÌ·Ì¨Ì¯Ì©ÍˆÍ‰Ì£Í‘Í†Í‚ÌšÃ¨Ì·Ì›ÌœÍ–Ì¬ÌªÌ³Ì±ÍÌÌˆÌ“ÌÌ‹ÍÍ…ÅÌ´Í–Ì‹ÌˆÌ“Ì
`,
  `
Ä®Ì¸Ì¤Ì£Ì¯ÌÌ€ÌÌ“ÍÍ’Í‹ ÌµÌ™Í‚Í›Ì“Í‘á¸©Ì¸Í‰ÌˆÌ“Ì‹Í’aÌ¸Í–Ì¤Ì£Ì–ÌžÌªÍ‹ÌˆÌÍŒÌˆÌÌšvÌ·Ì¡Ì¢Ì–Ì©Í”Í‡Ì»Ì…ÍŠÍŠÌ¿Ì¿Í›ÌšÍœÍ Í Í…á¸™ÌµÌ“ÌŠÌ‘Í†Ì‘ÌÍŠÍ Í nÌ¶ÌŸÌ»Í“Ì™Ì«Ì¤Í‰Ì¬Ì‰ÌÍ†Ì€ÌˆÌ“Ì…Ì•ÌšÌ•'Ì´Ì›ÌºÌ™ÌžÌ¼Ì²Í‹Ì’ÌÍ‘ÌˆÌÌ‘ÍtÌ´ÌºÌ»Ì£ÌÌÌƒÌ€Í‚Ì‚ÌˆÍ  Ì·Ì¥Ì—Ì°Ì©Ì¹Í‚ÌŒÍ›ÍŒÅ¡Ì´Ì«Ì˜Ì¦Ì¦Ì¼Ì³Ì“Ì‹Ì€Ì‰Í†ÍeÌ·ÌŸÌ™Ì¥ÌœÍ‰ÌÌ”ÍŠÍ†ÌˆÌÌ‰ÌˆÍ‹Ì‚Í›Í‘Í…á¸›Ì¸Ì¢ÍŠÌˆÌŠÌŠÌ¿nÌ·Í™ÌªÍ‰Ì©Í‡Í‘Ì“ Ì¸ÍŽÌ­Ì°Ì³Í™Ì¤ÌÇŽÌ·Ì¿ÌÌ¾ÌšÍœÍ Ì¸ÍšÌ©Ì»ÌžÌ¼Í“Ì–Ì¤ÌœÌŽÌ¾ÌˆÌ‹Ì½ÌÌ‚Í˜ÍnÌ¸Ì®Í‡Ì’ÌÌ‚ÍÈ©Ì·ÌªÌ™Ì Ì Ì¯Ì©Ì«ÌˆÌÌˆÌÌ‡ÌŠÌ‰ÌˆÌÌ‘Í›Ì•ÍœwÌ´Ì¡Ì¢Ì©Í‡Ì±ÌœÌ¦Í–ÍˆÌžÌ…Ì¾Ìš Ì´Í’Í‚Ì¾Í…cÌ¸Í•Ì¯Ì™Ì–Ì°Ì°ÌºÍ–Í–Ì­Ì•yÌ·Ì³Ì¥Ì¦Ì®Í‚Ì†Í›Ì¾Ì‰Ì•cÌ¶Ì¡Ì£Ì—Ì ÌÍ‰ÍšÌ¥ÌŠÌ‹Ì…Ì“ÌŒÌ€Ì†Ì”ÌlÌ·Í™Ì¬Ì—Ì™Ì’ÌŠÌˆÌƒÌ¾ÌšÍ eÌ¸Ì˜Í‚Ì“ÌŽÌ‚Ì„Ì“Í Ì¶Ì¨Ì¡Ì—Ì¹Í”Í‡Ì¹ÌÌ½ÍŠÍ†ÌˆÍ…sÌ¶ÍŽÍŒÌ†Í‹Ì‰ÌˆÍ—ÍÌšÍÍ iÌ´Ì²Ì–ÌŸÍÌ­Ì£ÍŽÌ°ÌŽÌÍ‹ÌÌŽÌ“Í›ÌÍ˜Í á¹‡Ì·Ì¦Í“Ì¾Ì‰Í‚Í›Ì½Ì‹Í—Í›cÌ·Ì­ÍšÍˆÌ¹Ì‘ÌŠÍ…È‡Ì¶ÌŸÌ’ Ì´Í–Ì—Ì Ì°Í•Ì²Ì¤Ì¹Ì…Ì½ÌˆtÌ´ÍšÌÌ€Ì“ÌÌÌ“ÍhÌ¸Ì¡Í”Ì Ì³Ì—Ì½Ì€Ì‚È©ÌµÌ˜Í‰Ì“ÌÌŠÌ’ÌˆÍ Ì´Ì¹Ì®ÍÌ®Ì²Ì°Ì—Ì­ÍˆÍ›ÌÍ‘ÍŒÍÌ„Ì•Ä¼ÌµÌ¢Ì¯ÌŸÌ Ì»Í“Ì°Í“Í›ÍœaÌ·Ì¢Ì»Ì¼ÌžÍšÌ«Ì«ÌŽÌÌ€ÌŽÌÌ„ÌƒÌ„Í†ÍsÌµÌ¡Ì»ÌŸÌ­Ì£Ì¼ÍŽÌ»Ì®Í™ÌˆÈ›ÌµÌ˜ÌÌÌƒÌ‰Í›ÌÌ„Í‹Ì„Ì Ì¸Ì¨Ì–Í”ÌŸÌºÌ½Ì€Ì‡Ìáº—Ì¶ÍÍ”Ì°Í‰Ì­Ì»Ì³Ì©Ì ÌÌÌÍŠÌŒiÌ´Ì—Ì“ÍÌ¾Ì†mÌµÍŽÍ”Ì¯Ì Ì©Ì¦Ì—ÍŽÌ‰Ì‰Í‹ÌÌÌ‚ÍÍ…Ã«Ì¶ÌœÌÌŒÌ…ÌÌŽ
`,
  `sÌ¸Ì®Í–ÍÌŠÌ‚Í…á¸™Ì´Ì›Í™Ì±Ì¹ÌŠÌ”Ì€Ì‚Ì½Ì„ÌÌ”Ì¾eÌ¸ÌŸÌŽ Ì¸ÍÍ“Ì¥ÌºÍ–Ì¹ÍšÍŒÌ’ÌšyÌ¶Ì¨ÌªÌœÍ•ÍˆÌ®Ì«Í•Ì®Ì†Ì‚Ì¾Ì¿Ì†Í†ÍŒÍÍŒoÌ¶Í™Ì–Ì…Ì¾ÃºÌ¶Ì¥Ì± Ì¸Ì«Ì²ÌœÍ–Í•Ì™Ì–Ì®Ì‡ÍŠÍ‚Ì‘Ì½Í iÌ´ÍÌªÍ‹ÌÍŒÌÌ”Ì“ÌŠÍnÌµÌ¨ÌªÌ«Í™ÍŽÍ–ÌˆÌÌ„Ì†ÍŠÍ Ì·Ì Ì¥Ì¦Ì¤ÌºÍ”Í–Ì¯Ì£ÍˆÌ•ÍtÌ¶Ì¢Ì¯Í‡ÌŸÌ³ÍŽÍšÌÌšÍœÄ¥Ì¸ÌžÌ Ì¯ÌœÌ¹Í•ÌÌ‰ÌˆÌŒÌ¿ÍŒÌ‰Ì‰ÍœÄ—Ì¶Ì±Ì£Ì—Í–ÌŸÌ˜ÌœÍ‚ÍŒÍ’ÌˆÌ†ÌˆÌ“Ì•Íœ ÌµÌ¢ÌžÌ¹ÍšÌ¼Ì®Ì”ÌˆÌÌ…ÌŠÍÌ€Ì€ÌÌÍŠfÌ´Ì¨Ì§Ì²Í”Ì²Ì Ì»Ì­Í†Ì’ÌˆÌÌ•ÇœÌ¸Ì¡Í“Ì¹Í•Ì—Ì¼ÌÌ®ÌƒÌˆÌÍ‚ÌŠÍá¹¯Ì´Ì¨Ì­Ì²Ì™ÌˆÌÌˆÌÍÍÆ°Ì¸Í”ÌºÍ‰Ì¯Ì„Ì„ÍŠÌ‚ÌŒÌšÌšÍœÍ á¹›ÌµÍ›Ì€Í—Ì€ÍÈ©Ì¸Ì¨Ì¡Ì–Ì¼Ì¬Ì®Ì²Ì…Í‘Í’Ì¿ÌÌ¿ÌÍŒÍ Ì·Ì§Ì§ÌªÌœÌ²Ì£Ì°ÌÌ•ÍœÃ¯Ì¶ÌÍ™Ì©ÌŸÌ¦Ì™ÍÍˆÌ³ÍœÍfÌ´Ì»Ì¼Ì¤Ì‰ÌÌ‚Ì‹ÌˆÌÌ€ÍÍÍ… Ì·Í–ÌžÌ¹Ì¤Ì«Í•Ì³ÌƒÌŽÍ Í…Å†ÌµÌ¥Ì°Í“Ì˜ÌªÍ•ÌÌÌ½Ì½Ì“ÌÌ¿Í…á¹Ì´ÌžÌ–Ì¹Ì–ÌŒÌŽÌÌ„Í†Í†Ì•Ì•tÌ¶Ì¤Ì®ÍŽÌ­Ì Ì¹ÌÍ—ÌŠÌ¾Ì• ÌµÍ™Í–Ì³Í‚Í’lÌ·Ì¨Ì¦Ì»Ì«Ì¼Í–Ì»Ì³Ì€ÌˆÌˆÌÌ‘Í‚Ì„Í Ã£Ì¸Ì»Ì–Ì¹Ì¼Ì¼ÌÌ„Ì†Ì¿Ì€Ì“Ì¾Ì¿Ì•tÌ·Ì›Ì©ÍŽÌ˜Ì†Ì’Í†Ì¾ÌƒÌ‘Ì‹ÍœÄ™ÌµÌ™Ì’rÌ´Í™Ì¹Ì Ìš
`,
];

const messageHandler = (dict: Message) => {
  
  if (dict.progNum || dict.midichan === undefined) {
    return;
  }


  const emoji =
    dict.s === "rytm"
      ? eMap[dict.midichan ?? 12] ?? "ðŸ« "
      : (dict.amp ?? 0) > 0.4 ? eMap2[dict.midichan ?? 12] : "";

  if (dict.cycle % 25 === 0) {
    process.stdout.write(
      ` ${dict.cycle} cycles ${modWords[Math.floor(dict.cycle) % 3]} `
    );
  }

  process.stdout.write(`${emoji}${emoji}`);

  if (!dict.isCc && dict.s === "rytm" && dict.midichan === 2) {
    const hsh = hash(dict).substring(0, 16);

    process.stdout.write(` ${zalgo(hsh)} `);
  }
};

run(messageHandler);
